<nav class="navbar navbar-static-top">
  <a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button"> </a>
  <div class="navbar-custom-menu">
    <ul class="nav navbar-nav">
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#" aria-expanded="false">
          <i class="far fa-bell"></i>
          <span class="badge badge-warning navbar-badge" id="notification"><%= @notifications.size %></span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right" style="left: inherit; right: 0px;">
          <span class="dropdown-item dropdown-header"><%= @notifications.size %> Notifications</span>
          <div class="dropdown-divider"></div>
          
          <% @notifications.each do |notification| %>
            <%= link_to message_path(notification), class: 'dropdown-item' do %>
              <span><%= notification.sender_name %>:</span> <span> <%= truncate(extract_text(notification.content), length: 20) %> </span>
              <span class="float-right text-muted text-sm"><%= time_ago_in_words(notification.created_at) %> ago</span>
            <% end %>
            <div class="dropdown-divider"></div>
          <% end %>
          <%link_to 'See All Notifications', messages_path%>
        </div>
      </li>
      <li class="dropdown user user-menu">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
          <%= image_tag ('avatar.png'), class: "user-image" %>
          <span class="hidden-xs"><%= current_user.name %></span>
        </a>
        <ul class="dropdown-menu">
          <li class="user-header">
            <%= image_tag ('avatar.png'), class: "img-circle" %>
            <p>
              <%= current_user.email %> - Spericorn
              <small>Member since Nov. 2012</small>
            </p>
          </li>
          <li class="user-footer">
            <div class="pull-left"></div>
            <div class="pull-right">
              <%= link_to "Sign out",destroy_user_session_path, method: :delete,
              class: "btn btn-default btn-flat" %>
            </div>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</nav>
